<Window x:Class="PageLeaf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PageLeaf"
        xmlns:viewmodels="clr-namespace:PageLeaf.ViewModels"
        xmlns:utils="clr-namespace:PageLeaf.Utilities"
        xmlns:views="clr-namespace:PageLeaf.Views"
        mc:Ignorable="d"
        Title="PageLeaf Markdown Editor" Height="600" Width="1000">
    <Window.InputBindings>
        <KeyBinding Key="S" Modifiers="Control" Command="{Binding SaveFileCommand}"/>
        <KeyBinding Key="S" Modifiers="Control+Shift" Command="{Binding SaveAsFileCommand}"/>
        <KeyBinding Key="O" Modifiers="Control" Command="{Binding OpenFileCommand}"/>
        <KeyBinding Key="N" Modifiers="Control" Command="{Binding NewDocumentCommand}"/>
    </Window.InputBindings>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Menu -->
            <RowDefinition Height="Auto"/> <!-- ToolBar -->
            <RowDefinition Height="*"/>    <!-- Main Content -->
        </Grid.RowDefinitions>

        <!-- Menu -->
        <Menu Grid.Row="0">
            <MenuItem Header="{StaticResource MenuFileHeader}">
                <MenuItem Header="{StaticResource MenuFileNewHeader}" Command="{Binding NewDocumentCommand}" InputGestureText="Ctrl+N"/>
                <MenuItem Header="{StaticResource MenuFileOpenHeader}" Command="{Binding OpenFileCommand}" InputGestureText="Ctrl+O"/>
                <Separator/>
                <MenuItem Header="{StaticResource MenuFileSaveHeader}" Command="{Binding SaveFileCommand}" InputGestureText="Ctrl+S"/>
                <MenuItem Header="{StaticResource MenuFileSaveAsHeader}" Command="{Binding SaveAsFileCommand}" InputGestureText="Ctrl+Shift+S"/>
                <Separator/>
                <MenuItem Header="{StaticResource MenuFileExportHeader}">
                    <MenuItem Header="{StaticResource MenuFileExportHtmlHeader}"/>
                    <MenuItem Header="{StaticResource MenuFileExportPdfHeader}"/>
                    <MenuItem Header="{StaticResource MenuFileExportWordDocxHeader}"/>
                    <MenuItem Header="{StaticResource MenuFileExportImagePngHeader}"/>
                </MenuItem>
                <Separator/>
                <MenuItem Header="{StaticResource MenuFileExitHeader}"/>
            </MenuItem>
            <MenuItem Header="{StaticResource MenuEditHeader}">
                <MenuItem Header="{StaticResource MenuEditCutHeader}"/>
                <MenuItem Header="{StaticResource MenuEditCopyHeader}"/>
                <MenuItem Header="{StaticResource MenuEditPasteHeader}"/>
                <Separator/>
                <MenuItem Header="{StaticResource MenuEditUndoHeader}"/>
                <MenuItem Header="{StaticResource MenuEditRedoHeader}"/>
            </MenuItem>
            <MenuItem Header="{StaticResource MenuViewHeader}">
                <MenuItem Header="{StaticResource MenuViewModelHeader}">
                    <MenuItem Header="{StaticResource MenuViewerViewModeHeader}"/>
                    <MenuItem Header="{StaticResource MenuViewMarkdownEditModeHeader}"/>
                    <MenuItem Header="{StaticResource MenuViewRealtimeEditModeHeader}"/>
                </MenuItem>
                <MenuItem Header="{StaticResource MenuViewCssSelectHeader}"/>
            </MenuItem>
            <MenuItem Header="{StaticResource MenuSettingsHeader}">
                <MenuItem Header="{StaticResource MenuSettingsSettingsHeader}"/>
            </MenuItem>
            <MenuItem Header="{StaticResource MenuHelpHeader}">
                <MenuItem Header="{StaticResource MenuHelpAboutHeader}"/>
            </MenuItem>
        </Menu>

        <!-- ToolBar -->
        <Border Grid.Row="1" Style="{StaticResource ToolBarLikeBorder}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <ComboBox ItemsSource="{Binding AvailableModes}" SelectedItem="{Binding Editor.SelectedMode}" Style="{StaticResource DisplayModeComboBoxStyle}"/>
                    <ComboBox ItemsSource="{Binding AvailableCssFiles}" SelectedItem="{Binding SelectedCssFile}" Style="{StaticResource CssFileComboBoxStyle}"/>
                </StackPanel>

                <Button Grid.Column="3" Content="CSS編集" Command="{Binding ToggleCssEditorCommand}" Style="{StaticResource ToolBarButtonStyle}"/>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- 左側の区画 (エディタ) -->
            <Grid Grid.Column="0">
                <TextBox Text="{Binding Editor.EditorText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         Margin="5"
                         Visibility="{Binding Editor.IsMarkdownEditorVisible, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                <WebBrowser x:Name="MarkdownViewer"
                            Margin="5"
                            Visibility="{Binding Editor.IsViewerVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                            utils:WebBrowserHelper.Html="{Binding Editor.HtmlContent}"/>
            </Grid>

            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Left" VerticalAlignment="Stretch" ShowsPreview="True"/>

            <views:CssEditorView Grid.Column="1"
                                 DataContext="{Binding CssEditorViewModel}"
                                 Visibility="{Binding IsCssEditorVisible, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        </Grid>
    </Grid>
</Window>
