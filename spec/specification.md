# Markdown CSS エディター マスター仕様書

## 1. プロジェクト概要

本アプリケーションは、Markdown ドキュメントのデザイン（CSS）作成・編集に特化したデスクトップツールとする。

ユーザーは、プレビュー画面でリアルタイムにスタイルの変化を確認しながら、GUI を通じて直感的に Markdown 用の CSS を作成・編集できるものとする。Markdown エディターとしての機能も備え、スタイル確認用のテキスト編集を同一画面内でシームレスに行う環境を提供する。

## 2. 仕様ドキュメント体系

本プロジェクトの仕様は、情報の性質と開発における役割に応じて「機能」「UI/UX」「技術」の 3 つのカテゴリに分類して定義する。

### 2.1. 機能仕様 (Functional)

アプリケーションがユーザーに提供する具体的な価値と、それを実現するための振る舞いを定義する。エディタの入力支援やファイルの永続化、および本アプリの核心である CSS 編集ロジックの詳細を規定する。

- **[エディタ機能](functional/editor.md)**: AvalonEdit を用いた編集・入力支援
- **[ファイル操作・管理](functional/file_management.md)**: 新規作成、保存、外部変更検知
- **[CSS 編集・管理](functional/css_editor.md)**: GUI によるスタイル編集、単位変換、ファイル管理
- **[YAML フロントマター](functional/frontmatter.md)**: メタデータ処理、予約プロパティ、プレビュー制御
- **[システム設定](functional/system_settings.md)**: ログ出力設定、アプリケーションの動作環境設定

### 2.2. UI/UX 仕様 (User Interface)

ユーザーが触れるインターフェースの一貫性と、心地よい操作体験（UX）のための規約を定義する。画面の物理構成から、インタラクションによるフィードバック、デザインシステムの思想までを網羅する。

- **[画面構成・レイアウト](ui/window_layout.md)**: メインウィンドウ、設定画面、チートシートの構造
- **[インタラクション・振る舞い](ui/interaction.md)**: モーダル挙動、Dirty インジケータ、TOC ジャンプ
- **[デザインシステム](ui/design_system.md)**: カラーシステム、Soft Emphasis 規約
- **[デザインシステム指針](ui/%23デザインシステムとは.md)**: デザインシステムの思想と運用ルール

### 2.3. 技術仕様 (Technical)

開発者が実装にあたって遵守すべき構造的基準を定義する。クリーンアーキテクチャに基づいたレイヤー分離やドメインモデルの設計指針、および具体的な実装規約を定める。

- **[アーキテクチャ](technical/architecture.md)**: レイヤー分離、MVVM の純粋性、DI
- **[実装規約・標準](technical/standards.md)**: リソース管理、品質担保、コーディング規約

## 3. 採用技術

本アプリケーションは、Markdown の手軽さと CSS による高度な表現力を両立させるため、それぞれの分野で定評のある技術を組み合わせて構築する。

### 3.1. 開発基盤とアーキテクチャ

実行プラットフォームには .NET 8.0 を採用し、WPF によって豊かなデスクトップ体験を提供する。システム全体の柔軟性とテスト容易性を確保するため、DI を基盤とした MVVM アーキテクチャを指向する。

- **言語**: C# (.NET 8.0)
- **UI フレームワーク**: WPF (Windows Presentation Foundation)
- **DI コンテナ**: Microsoft.Extensions.Hosting

### 3.2. エディタおよびレンダリング・スタック

ユーザーの入力体験を支えるエディタエンジンと、モダンな Web スタンダードに準拠した表示を保証する描画エンジンを核とする。

- **エディタエンジン**: AvalonEdit (シンタックスハイライト、入力支援)
- **プレビューエンジン**: Microsoft.Web.WebView2 (Chromium ベース)
- **Markdown 変換**: Markdig
- **CSS 操作**: AngleSharp / AngleSharp.Css (動的スタイル更新)

### 3.3. データ管理とシステムサポート

人間と機械の両方に可読性の高いデータ形式を採用し、文字コードの維持や構造化ログによる診断性を確保する。

- **設定・メタデータ**: YamlDotNet (YAML フロントマター、アプリ設定)
- **文字コード検知**: Ude.NetStandard (文字コードの自動判別)
- **ロギング**: Serilog (構造化ログ、ファイル出力)
- **配布形態**: 単一ファイル実行形式 (SingleFile) へのパッケージング
