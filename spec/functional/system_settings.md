# 機能仕様：システム設定

## 1. 概要

本ドキュメントでは、アプリケーションの振る舞い、外観、および環境設定に関する仕様を定義する。
これらの設定は、ユーザーの好みに応じて変更可能であり、アプリケーション終了後も永続化される。

## 2. 設定カテゴリ

設定画面は以下のカテゴリに分類される。

### 2.1. 外観 (Appearance)

アプリケーション全体の視覚的なテーマを設定する。

- **テーマ (Theme)**:
  - **システム**: OS の設定（ライト/ダーク）に追従する。
  - **ライト**: 常にライトテーマを使用する。
  - **ダーク**: 常にダークテーマを使用する。
- **ライブラリ読み込み先 (LibraryResourceSource)**:
  - **ローカル**: アプリケーションに内包されたリソースを使用する（オフライン可）。
  - **CDN**: インターネット経由で最新のライブラリ（Highlight.js, Mermaid）を取得する。

### 2.2. エディタ (Editor)

Markdown エディタの操作感や挙動を設定する。

- **フォントサイズ**: エディタの文字サイズ（1.0 〜 100.0 px）。
- **インデント設定**:
  - **スペースを使用**: タブキー押下時にスペースを入力するかどうか。
  - **インデント幅**: 1 つのインデントレベルに対するスペースの数（1 〜 32）。
- **脚注設定**:
  - **保存時に番号を振り直す**: ファイル保存時、脚注番号（[^1]など）を出現順に自動で連番（1, 2, 3...）にリナンバーするかどうか。
- **フロントマター設定**:
  - **プレビューにタイトルを表示**: フロントマターの `title` をプレビューの最上部に表示するかどうか。
  - **新規作成時に自動挿入**: 新規ファイル作成時、テンプレートとなるフロントマターを自動的に挿入するかどうか。
  - **追加プロパティ**: 自動挿入時に追加するカスタムプロパティ（キーと初期値）。

### 2.3. 画像・ファイル (Image)

画像の取り扱いに関する設定。

- **保存先フォルダ**: 画像貼り付け時にファイルを保存するディレクトリ（Markdown ファイルからの相対パス）。
- **ファイル名テンプレート**: 保存される画像ファイル名の形式。
  - 変数: `{Date}`, `{Time}`, `{FileName}` が利用可能。

### 2.4. 表示・コード (Code)

プレビューおよびコードブロックの表示設定。

- **コードハイライト テーマ**: コードブロックのシンタックスハイライトに使用するテーマ（GitHub, Solarized 等）。
- **カスタムスタイルの適用**: CSS エディタで設定したスタイル（フォントや背景色）を、コードブロックのテーマ設定よりも優先して適用するかどうか。

### 2.5. 診断・ログ (Diagnostic)

アプリケーションの動作ログに関する設定。

- **ログ出力レベル (MinimumLogLevel)**:
  - **標準 (Standard)**: 通常の操作履歴、警告、エラーを出力する（デフォルト）。
  - **開発用 (Development)**: 開発・調査用の詳細なデバッグ情報を含めてすべて出力する。
- **ファイル出力 (EnableFileLogging)**: ログをローカルファイル（`logs/`）に出力するかどうか。

## 3. 設定の永続化

- **保存形式**: YAML 形式 (`settings.yaml`)。
- **保存場所**: 実行ファイルと同階層、またはアプリケーションデータフォルダ。
- **適用タイミング**:
  - 多くの設定は変更後に「保存」ボタンを押下したタイミングで即座に反映される。
  - ログレベルなどのシステム設定も動的に反映される。
